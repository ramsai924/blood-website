<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" href="/public/style/home.css">
    <title>Document</title>
</head>

<body>


<div>
    <nav class="navbar navbar-expand-sm bg-dark navbar-dark">
        <div class="container">
            <!-- Brand/logo -->
            <a class="navbar-brand" href="/">Logo</a>

            <!-- Links -->
            <ul class="navbar-nav" id="navbar-res">
                <!-- <li class="nav-item" style="margin-left:5px">
                            <a class="nav-link" href="#" >Profile</a>
                        </li> -->
                <%  if(userset){ %>
                <li class="nav-item" style="margin-left:5px">
                    <a class="btn btn-primary" href="/profile" style="background: transparent;">profile</a>
                    <a class="btn btn-primary" href="/logout" style="background: transparent;">Logout</a>
                </li>
                <% }else{ %>
                <li class="nav-item">
                    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal"
                        style="background: transparent;">
                        Sign in
                    </button>
                </li>
                <%  } %>

            </ul>
        </div>
    </nav>
</div>

<% if(userset){ %>
    <div class="container">
       
          <div style="background: grey;">
                <div>
                    <p>Name : <%= userset.name %></p>
                    <p>Email : <%= userset.email %></p>
                    <p>Phone Number : <%= userset.phoneNumber %></p>
                    <p>User Type : <%= userset.usertype %></p>
                    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#model<%= userset._id %>">
                        Edit
                    </button>

                    <!-- popup model for post edit -->
                    <div class="modal fade" id="model<%= userset._id %>" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
                        aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                    
                    
                                <div class="modal-body">
                                    <form action="/editprofile/<%= userset._id %>" method="POST">
                                       
                                        <div class="form-group">
                                            <label for="name">Name: <span style="color: red;">*</span></label>
                                            <input type="text" class="form-control" value="<%= userset.name %>" name="name">
                                        </div>
                                        <div class="form-group">
                                            <label for="email">Email: <span style="color: red;">*</span></label>
                                            <input type="text" class="form-control" value="<%= userset.email %>" name="email">
                                        </div>
                    
                                        <div class="form-group">
                                            <label for="phonenumber">Phone Number: <span style="color: red;">*</span></label>
                                            <input type="text" class="form-control" value="<%= userset.phoneNumber %>" name="phoneNumber">
                                        </div>
                                        <div class="form-group">
                                            <label for="usertype">User Type : <span style="color: red;">* </span></label>
                                            <select id="usertype" name="usertype" class="form-control">
                                                <option value="<%= userset.usertype %>"><%= userset.usertype %></option>
                                                <option value="search">Search</option>
                                                <option value="donar">Donar</option>
                                            
                                            </select>
                                        </div>
                                </div>
                    
                    
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                    <button type="submit" class="btn btn-primary">Submit</button>
                                </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
          </div>
      
    </div>
<% } %>

<% if(message.length > 0){ %>
<div class="alert alert-success alert-dismissible" style="position: fixed;" role="alert" id="alerts">
    <strong><%= message %></strong>
    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true" style="text-decoration: none;">&times;</span>
    </button>
</div>

<% } %>


   <% if(typeof userData === "object" && userData.length !=0 || typeof search === "object" && search.length != 0 ){ %>
        <div class="container">
           <% if(userData){ %>
            <% userData.forEach((data) => { %>
            <div>
                <p><%= data.Bloodgroup %></p>
                <p><%= data.Donatstatus %></p>
            </div>
            <% }) %>
            <% } %>
        </div>
        
        <div class="container">
            <% if(search.length != 0){ %>
            <h2>Your Posts</h2>
            <% search.forEach((data) => { %>
            <div style="background: grey;margin-top: 10px;padding: 10px;">
                <p>Blood Group : <%= data.Bloodgroup %></p>
                <p>Donar status : <%= data.Donatstatus %></p>
                <p>Patient Name : <%= data.patientname %></p>
                <p>Donataion Date : <%= data.date %></p>
                <p>Hospital Name : <%= data.hospitalName %></p>
                <p>Address : <%= data.city %> , <%= data.district %> , <%= data.state %> , <%= data.zipcode %></p>
                <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#model<%= data._id %>">
                    Edit
                </button>
                <a href="/deletepost/<%= data._id %>">Delete</a>

                <!-- popup model for post edit -->
                <div class="modal fade" id="model<%= data._id %>" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
                    aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>


                            <div class="modal-body">
                                <form action="/editpost/<%= data._id %>" method="POST">
                                    <div class="form-group">
                                        <label for="patientname">patientname: <span style="color: red;">*</span> </label>
                                        <input type="text" class="form-control" id="patientname" placeholder="Enter patientname" name="patientname"
                                            value="<%= data.patientname %>" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="date">Date of donation: <span style="color: red;">*</span> </label>
                                        <input type="date" class="form-control" id="date" placeholder="Enter date" name="date" value="<%= data.date %>" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="Donatstatus">status : <span style="color: red;">* </span></label>
                                        <select id="Donatstatus" name="Donatstatus" class="form-control">
                                            <option value="<%= data.Donatstatus %>"><%= data.Donatstatus %></option>
                                            <option value="active">Active</option>
                                            <option value="inactive">Inactive</option>
                                          
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="Bloodgroup">Blood group :  <span style="color: red;">*  </span></label>
                                        <select id="Bloodgroup" name="Bloodgroup" class="form-control" >
                                            <option value="<%= data.Bloodgroup %>"><%= data.Bloodgroup %></option>
                                            <option value="O-">O-</option>
                                            <option value="O+">O+ </option>
                                            <option value="A-">A-</option>
                                            <option value="A+">A+</option>
                                            <option value="B-">B-</option>
                                            <option value="B+">B+</option>
                                            <option value="AB-">AB-</option>
                                            <option value="AB+">AB+</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="hospitalName">hospitalName: <span style="color: red;">*</span></label>
                                        <input type="text" class="form-control" value="<%= data.hospitalName %>" placeholder="Enter hospitalName" name="hospitalName">
                                    </div>
                                    <div class="form-group">
                                        <label for="PhoneNumber">PhoneNumber: <span style="color: red;">*</span></label>
                                        <input type="text" class="form-control" value="<%= data.PhoneNumber %>" placeholder="Enter PhoneNumber" name="PhoneNumber">
                                    </div>
                                
                                    <div class="form-group">
                                        <label for="zipcode">Zipcode: <span style="color: red;">*</span></label>
                                        <input type="text" class="form-control" value="<%= data.zipcode %>" placeholder="Enter zipcode" name="zipcode">
                                    </div>
                                    <div class="form-group">
                                        <label for="city">city: <span style="color: red;">*</span></label>
                                        <input type="text" class="form-control" value="<%= data.city %>" placeholder="Enter city" name="city">
                                    </div>
                                    <div class="form-group">
                                        <label for="district">District: <span style="color: red;">*</span></label>
                                        <input type="text" class="form-control" value="<%= data.district %>" placeholder="Enter district" name="district">
                                    </div>
                                    <div class="form-group">
                                        <label for="state">State: <span style="color: red;">*</span></label>
                                        <input type="text" class="form-control" value="<%= data.state %>" placeholder="Enter state" name="state">
                                    </div>
                            </div>


                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                <button type="submit" class="btn btn-primary">Submit</button>
                            </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <% }) %>
            <% } %>
        </div>
   <% }else{ %>
        <div class="container">
            <p>You have no activity</p>
        </div>
   <% } %>
</body>
<script>
    setTimeout(() => {
        document.getElementById("alerts").style.display = "none"
    }, 3000);
</script>
</html>